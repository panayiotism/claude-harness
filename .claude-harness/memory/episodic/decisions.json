{
  "maxEntries": 50,
  "entries": [
    {
      "id": "dec-20260110-001",
      "timestamp": "2026-01-10T05:20:00Z",
      "feature": "feature-011",
      "decision": "Use deny > ask > allow precedence for permission safety",
      "rationale": "Deny rules must have highest precedence to block dangerous commands even if they match ask/allow patterns",
      "alternatives": ["Only use allow list", "Use ask for everything"],
      "impact": ".claude/settings.json, .claude/settings.local.json"
    },
    {
      "id": "dec-20260110-002",
      "timestamp": "2026-01-10T05:20:00Z",
      "feature": "feature-011",
      "decision": "Put rm:* in ask list with specific dangerous patterns in deny",
      "rationale": "This allows safe rm commands (like rm node_modules) with user confirmation, while blocking destructive patterns (rm -rf /) unconditionally",
      "alternatives": ["Block all rm commands", "Allow all rm commands"],
      "impact": ".claude/settings.json"
    },
    {
      "id": "dec-20260110-003",
      "timestamp": "2026-01-10T05:20:00Z",
      "feature": "feature-011",
      "decision": "Create both settings.json (shared) and settings.local.json (personal)",
      "rationale": "Team-shared settings ensure consistent safety across all users, while personal settings allow customization without affecting others",
      "alternatives": ["Only create settings.local.json"],
      "impact": ".claude/settings.json, .claude/settings.local.json"
    },
    {
      "id": "dec-20260115-001",
      "timestamp": "2026-01-15T14:35:00Z",
      "feature": "feature-012",
      "decision": "Create separate /do-tdd command instead of --tdd flag on /do",
      "rationale": "User preferred explicit command over additional flag to reduce complexity. Separate command makes TDD workflow first-class and clear.",
      "alternatives": ["Add --tdd flag to /do", "Make TDD default with --skip-tdd opt-out"],
      "impact": "commands/do-tdd.md, README.md"
    },
    {
      "id": "dec-20260115-002",
      "timestamp": "2026-01-15T14:35:00Z",
      "feature": "feature-012",
      "decision": "Enforce test existence gate - block implementation until tests exist",
      "rationale": "True TDD requires tests to exist before implementation. Gate ensures workflow is followed, not just suggested.",
      "alternatives": ["Warning only (no blocking)", "Optional enforcement via flag"],
      "impact": "commands/do-tdd.md"
    },
    {
      "id": "dec-20260115-003",
      "timestamp": "2026-01-15T14:35:00Z",
      "feature": "feature-012",
      "decision": "Use RED-GREEN-REFACTOR phases with explicit phase tracking",
      "rationale": "Classic TDD cycle provides clear structure. Phase tracking in loop state enables resume from any point.",
      "alternatives": ["Simple test-first without phases", "Only track test pass/fail"],
      "impact": "commands/do-tdd.md, .claude-harness/loops/state.json schema"
    },
    {
      "id": "dec-20260115-004",
      "timestamp": "2026-01-15T15:00:00Z",
      "feature": "feature-012",
      "decision": "Re-tag version after merge to include actual feature code",
      "rationale": "v3.7.0 was originally tagged on pre-merge commit. After squash merge, tag needed to be moved to include the actual feature implementation.",
      "alternatives": ["Keep old tag", "Bump to v3.7.1"],
      "impact": "Git tags, GitHub releases"
    },
    {
      "id": "dec-20260115-005",
      "timestamp": "2026-01-15T15:00:00Z",
      "feature": "feature-012",
      "decision": "Use squash merge for feature PRs",
      "rationale": "Squash merge keeps main branch clean with one commit per feature. Preserves full history in PR for reference.",
      "alternatives": ["Merge commit", "Rebase and merge"],
      "impact": "Git history on main branch"
    },
    {
      "id": "dec-20260116-001",
      "timestamp": "2026-01-16T07:15:00Z",
      "feature": "feature-013",
      "decision": "Use quoted heredoc for init.sh content in setup.sh",
      "rationale": "Single quotes inside single-quoted string caused syntax error. Quoted heredoc (<<'EOF') preserves all special characters including single quotes",
      "alternatives": ["Escape quotes manually", "Use different delimiter syntax"],
      "impact": "setup.sh"
    },
    {
      "id": "dec-20260116-002",
      "timestamp": "2026-01-16T07:15:00Z",
      "feature": "feature-013",
      "decision": "Make gitignore update MANDATORY in /setup command",
      "rationale": "Previous soft instructions were not being followed. CRITICAL + DO NOT SKIP ensures ephemeral files are properly gitignored",
      "alternatives": ["Keep as optional", "Only add to setup.sh"],
      "impact": "commands/setup.md"
    },
    {
      "id": "dec-20260116-003",
      "timestamp": "2026-01-16T16:50:00Z",
      "feature": "feature-013",
      "decision": "Add CRITICAL marker and explicit DO NOT warning for multiSelect requirement",
      "rationale": "User reported that in plugin installations, the interactive menu only allowed single selection despite multiSelect: true in docs. More explicit instructions needed to ensure Claude follows the requirement.",
      "alternatives": ["Keep subtle instruction", "Remove multi-select entirely"],
      "impact": "commands/do.md"
    },
    {
      "id": "dec-20260201-001",
      "timestamp": "2026-02-01T12:00:00Z",
      "feature": "hotfix",
      "decision": "Convert Stop hook from prompt-type to command-type",
      "rationale": "Prompt-type hooks require a model to generate valid JSON on every stop/interrupt. This is inherently unreliable - the model can produce trailing backslashes, extra text, or malformed JSON, causing 'JSON validation failed' errors. Shell scripts are deterministic and never fail validation.",
      "alternatives": ["Simplify the prompt", "Remove Stop hook entirely", "Add retry logic"],
      "impact": "hooks/hooks.json, hooks/stop.sh"
    },
    {
      "id": "dec-20260206-001",
      "timestamp": "2026-02-06T15:45:00Z",
      "feature": "v5.0.0",
      "decision": "Stay within 200K standard context - do not use 1M beta context",
      "rationale": "1M context window is still in beta and triggers premium pricing ($10/$37.50 per MTok vs standard $5/$25 for >200K input). Requires usage tier 4 orgs. Not worth the cost increase for most users.",
      "alternatives": ["Use 1M context with tier detection", "3-tier system (standard/opus46/opus46-extended)"],
      "impact": "All commands - no memory limit changes needed"
    },
    {
      "id": "dec-20260206-002",
      "timestamp": "2026-02-06T15:45:00Z",
      "feature": "v5.0.0",
      "decision": "Effort annotations are advisory - backward compatible with older models",
      "rationale": "Models without effort controls simply ignore the annotations. This ensures the plugin works identically on older models while optimizing cost/quality on Opus 4.6+.",
      "alternatives": ["Model detection with conditional behavior", "Separate command variants per model"],
      "impact": "commands/flow.md, do.md, do-tdd.md, orchestrate.md"
    },
    {
      "id": "dec-20260206-003",
      "timestamp": "2026-02-06T15:45:00Z",
      "feature": "v5.0.0",
      "decision": "Agent Teams as preferred spawning mechanism with Task tool fallback",
      "rationale": "Agent Teams (research preview) provides native parallel agent spawning with separate context windows. Better coordination than custom Task tool approach. Fallback ensures compatibility when Agent Teams is unavailable.",
      "alternatives": ["Only use Task tool", "Only use Agent Teams (no fallback)", "Configurable via settings"],
      "impact": "commands/do.md, do-tdd.md, orchestrate.md"
    },
    {
      "id": "dec-20260206-004",
      "timestamp": "2026-02-06T15:45:00Z",
      "feature": "v5.0.0",
      "decision": "Increase maxAttempts from 10 to 15 across all commands",
      "rationale": "Opus 4.6 sustains longer agentic tasks with better debugging. 15 attempts with progressive effort escalation (high → max → max+memory) provides more runway for complex issues.",
      "alternatives": ["Keep at 10", "Increase to 20", "Make configurable per-project"],
      "impact": "commands/flow.md, do.md, do-tdd.md, checkpoint.md, setup.md, README.md"
    },
    {
      "id": "dec-20260206-005",
      "timestamp": "2026-02-06T15:45:00Z",
      "feature": "v5.0.0",
      "decision": "Simple single-update approach instead of complex tier system",
      "rationale": "User explicitly requested simplicity. All Opus 4.6 features are backward-compatible, so no need for model detection or tiered behavior. One plugin version works for all models.",
      "alternatives": ["3-tier system with model detection", "Feature flags per capability"],
      "impact": "Entire plugin architecture - kept simple"
    },
    {
      "id": "dec-20260207-001",
      "timestamp": "2026-02-07T15:00:00Z",
      "feature": "v6.0.0",
      "decision": "Replace entire subagent pipeline with Agent Teams as sole orchestration model",
      "rationale": "Agent Teams enable direct inter-agent messaging (reviewer↔implementer) which eliminates the lossy lead-intermediated handoffs of the old subagent pipeline. Per-feature specialist teams (test-writer, implementer, reviewer) naturally enforce TDD.",
      "alternatives": ["Keep subagent pipeline with Agent Teams as opt-in", "Dual orchestration with fallback"],
      "impact": "commands/flow.md (major rewrite), hooks/, setup.sh"
    },
    {
      "id": "dec-20260207-002",
      "timestamp": "2026-02-07T15:00:00Z",
      "feature": "v6.0.0",
      "decision": "Remove --tdd flag - TDD is always-on via team structure",
      "rationale": "The 3-specialist team (test-writer=RED, implementer=GREEN, reviewer=REFACTOR) IS the TDD cycle by design. A separate flag is redundant.",
      "alternatives": ["Keep --tdd as explicit opt-in", "Add --skip-tdd to opt out"],
      "impact": "commands/flow.md, CLAUDE.md, README.md, session-start.sh, init.sh"
    },
    {
      "id": "dec-20260207-003",
      "timestamp": "2026-02-07T15:00:00Z",
      "feature": "v6.0.0",
      "decision": "Remove worktree support entirely - Agent Teams handle parallelism",
      "rationale": "Agent Teams teammates each get their own Claude Code instance, making worktree-based isolation unnecessary. Removes complexity from 6 files without losing functionality.",
      "alternatives": ["Keep worktree as optional utility", "Only remove from flow, keep manual command"],
      "impact": "commands/worktree.md (deleted), flow.md, start.md, checkpoint.md, session-start.sh, setup.sh, README.md"
    },
    {
      "id": "dec-20260207-004",
      "timestamp": "2026-02-07T16:30:00Z",
      "feature": "v6.0.1",
      "decision": "Add migrate_to_v6() to setup.sh for automatic cleanup on upgrade",
      "rationale": "Target projects upgrading from v5.x retain stale artifacts (worktrees/, handoffs.json, obsolete commands). Automatic migration prevents confusion and stale state.",
      "alternatives": ["Manual cleanup instructions in changelog", "Force overwrite all files"],
      "impact": "setup.sh"
    },
    {
      "id": "dec-20260207-005",
      "timestamp": "2026-02-07T16:30:00Z",
      "feature": "v6.0.1",
      "decision": "Use python3 JSON merge for settings.local.json env var injection",
      "rationale": "create_file skips existing files. sed-based JSON manipulation is fragile. python3 json.load/dump safely merges the Agent Teams env var into any existing settings.local.json without losing user customizations.",
      "alternatives": ["sed-based injection", "Force overwrite settings.local.json", "Require manual setup"],
      "impact": "setup.sh, .claude/settings.local.json"
    },
    {
      "id": "dec-20260207-006",
      "timestamp": "2026-02-07T16:30:00Z",
      "feature": "v6.0.1",
      "decision": "Agent Teams env var blocker at session-start and flow Phase 0",
      "rationale": "Agent Teams is required for v6+ (all workflows depend on it). Blocking early prevents confusing failures deep in the workflow. Hooks can't set env vars (child process), so user must run setup + restart.",
      "alternatives": ["Warning only (non-blocking)", "Auto-enable via hook (impossible — child process)"],
      "impact": "hooks/session-start.sh, commands/flow.md"
    }
  ]
}
